// ==UserScript==
// @name BadooNearbyAutolike
// @author nemanjan00
// @include https://badoo.com/*
// @include https://*.badoo.com/*
// @include http://badoo.com/*
// @include http://*.badoo.com/*
// @downloadURL https://raw.githubusercontent.com/nemanjan00/BadooNearbyLike/master/badoo.user.js
// @namespace https://github.com/nemanjan00/BadooNearbyAutolike
// @updateURL https://raw.githubusercontent.com/nemanjan00/BadooNearbyLike/master/badoo.user.js
// @version 6
// ==/UserScript==

var code = atob("d2luZG93Lm9wZW5lciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJvcGVuZXIiKSB8fCAiS2FrbyBvdm8gcmFkaSwgamVzbW8gbGkgc2FkIHUgdmV6aT8gOjMiOwoKd2luZG93LmJvdCA9IHsKCWdldENoYXQ6IGZ1bmN0aW9uKGlkKXsKCQl2YXIgdXJsID0gIi9hcGkucGh0bWw/U0VSVkVSX09QRU5fTUVTU0VOR0VSIjsKCgkJdmFyIGJvZHkgPSB7InZlcnNpb24iOjEsIm1lc3NhZ2VfdHlwZSI6NDY4LCJtZXNzYWdlX2lkIjo0MSwiYm9keSI6W3sibWVzc2FnZV90eXBlIjo0NjgsInNlcnZlcl9vcGVuX21lc3NlbmdlciI6eyJjb250YWN0c191c2VyX2ZpZWxkX2ZpbHRlciI6eyJwcm9qZWN0aW9uIjpbMzMwLDIwMCw3MDAsNTgwLDY0MCw2MDAsNjEwLDI1MCwzNDAsMjgwLDIzMCw2NTAsODAwLDUwMV0sInByb2ZpbGVfcGhvdG9fc2l6ZSI6eyJzcXVhcmVfZmFjZV9waG90b19zaXplIjp7IndpZHRoIjoxMDAsImhlaWdodCI6MTAwfX19LCJjaGF0X3VzZXJfZmllbGRfZmlsdGVyIjp7InByb2plY3Rpb24iOlszMzAsMzMxLDIwMCw3MDAsNTgwLDY0MCw2MDAsNjEwLDI1MCwzNDAsMjgwLDI5MCwyOTEsMzEwLDMwMSwzMDIsNjgwLDMwMywzMDQsMjEwLDIzMCw3MzEsNjUwLDU3MF0sInByb2ZpbGVfcGhvdG9fc2l6ZSI6eyJzcXVhcmVfZmFjZV9waG90b19zaXplIjp7IndpZHRoIjozMDAsImhlaWdodCI6MzAwfX19LCJpbml0aWFsX3NjcmVlbl91c2VyX2ZpZWxkX2ZpbHRlciI6eyJwcm9qZWN0aW9uIjpbNDEwLDQ5MCw0NzEsODAwXSwidW5pdGVkX2ZyaWVuZHNfZmlsdGVyIjpbeyJzZWN0aW9uX3R5cGUiOjF9XX0sInVzZXJfaWQiOmlkfX1dfTsKCgkJdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKCQkJYm90Ll9zZW5kUmVxdWVzdCh1cmwsIGJvZHkpLnRoZW4oZnVuY3Rpb24oY2hhdCl7CgkJCQljaGF0ID0gY2hhdC5ib2R5WzBdLmNsaWVudF9vcGVuX21lc3Nlbmdlci5hY3RpdmVfY2hhdC5pbml0aWFsX2NoYXRfc2NyZWVuOwoJCQkJCgkJCQlyZXNvbHZlKGNoYXQgIT0gdW5kZWZpbmVkICYmIGNoYXQudHlwZSA9PSAyKTsKCQkJfSk7CgkJfSk7CgkJcmV0dXJuIHByb21pc2U7Cgl9LAoJc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uKGlkKXsKCQl2YXIgdXJsID0gIi9hcGkucGh0bWw/U0VSVkVSX1NFTkRfQ0hBVF9NRVNTQUdFIjsKCgkJdmFyIGJvZHkgPSB7InZlcnNpb24iOjEsIm1lc3NhZ2VfdHlwZSI6MTA0LCJtZXNzYWdlX2lkIjoxNCwiYm9keSI6W3sibWVzc2FnZV90eXBlIjoxMDQsImNoYXRfbWVzc2FnZSI6eyJtc3NnIjp3aW5kb3cub3BlbmVyLCJtZXNzYWdlX3R5cGUiOjEsInVpZCI6IjE0ODQxODc5Nzg1MjAiLCJmcm9tX3BlcnNvbl9pZCI6IjIyNzU2MjIyNCIsInRvX3BlcnNvbl9pZCI6aWQsInJlYWQiOmZhbHNlLCJjaGF0X2Jsb2NrX2lkIjoyfX1dfTsKCgkJdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKCQkJYm90Ll9zZW5kUmVxdWVzdCh1cmwsIGJvZHkpLnRoZW4oZnVuY3Rpb24odXNlcil7CgkJCQlyZXNvbHZlKHRydWUpOwoJCQl9KTsKCQl9KTsKCQlyZXR1cm4gcHJvbWlzZTsKCX0sCglnZXRVc2VyOiBmdW5jdGlvbihpZCl7CgkJdmFyIHVybCA9ICIvYXBpLnBodG1sP1NFUlZFUl9HRVRfVVNFUiI7CgoJCXZhciBib2R5ID0geyIkZ3BiIjoiYmFkb28uYm1hLkJhZG9vTWVzc2FnZSIsInZlcnNpb24iOjEsIm1lc3NhZ2VfdHlwZSI6NDAzLCJtZXNzYWdlX2lkIjo2LCJib2R5IjpbeyIkZ3BiIjoiYmFkb28uYm1hLk1lc3NhZ2VCb2R5IiwibWVzc2FnZV90eXBlIjo0MDMsInNlcnZlcl9nZXRfdXNlciI6eyIkZ3BiIjoiYmFkb28uYm1hLlNlcnZlckdldFVzZXIiLCJ1c2VyX2lkIjppZCwiY2xpZW50X3NvdXJjZSI6MiwidXNlcl9maWVsZF9maWx0ZXIiOnsiJGdwYiI6ImJhZG9vLmJtYS5Vc2VyRmllbGRGaWx0ZXIiLCJwcm9qZWN0aW9uIjpbODAwLDM3MCwyMDAsMjMwLDIxMCwzMCwzNjAsOTMsMzAxLDMwMiw2ODAsMzAzLDMwNCwyNTAsNjAwLDI5MCwyOTEsNjEwLDMxMCw2OTAsNjkxLDY5Miw2OTMsNDQwLDMxMSw0OTAsNjYwLDY1MCw0NjAsNzUwLDczMSw3MzAsMTAwLDM0MCw1ODAsNTcwLDQxMCw0MjAsNDgwLDkwLDQ3MCw3NDIsNzQxLDc0MCw1NTAsNjgxLDY3MCw4NzAsMzMwLDMzMSwyNjAsNTMwLDU0MF0sInJlcXVlc3RfYWxidW1zIjpbeyIkZ3BiIjoiYmFkb28uYm1hLlNlcnZlckdldEFsYnVtIiwicHJldmlld19zaXplIjp7IiRncGIiOiJiYWRvby5ibWEuUGhvdG9TaXplIiwiaGVpZ2h0IjoxODAsIndpZHRoIjoxODB9LCJhbGJ1bV90eXBlIjoyfSx7IiRncGIiOiJiYWRvby5ibWEuU2VydmVyR2V0QWxidW0iLCJwcmV2aWV3X3NpemUiOnsiJGdwYiI6ImJhZG9vLmJtYS5QaG90b1NpemUiLCJoZWlnaHQiOjE4MCwid2lkdGgiOjE4MH0sImFsYnVtX3R5cGUiOjR9XSwidW5pdGVkX2ZyaWVuZHNfZmlsdGVyIjpbeyIkZ3BiIjoiYmFkb28uYm1hLlVuaXRlZEZyaWVuZHNGaWx0ZXIiLCJjb3VudCI6NSwic2VjdGlvbl90eXBlIjozfSx7IiRncGIiOiJiYWRvby5ibWEuVW5pdGVkRnJpZW5kc0ZpbHRlciIsImNvdW50Ijo1LCJzZWN0aW9uX3R5cGUiOjF9LHsiJGdwYiI6ImJhZG9vLmJtYS5Vbml0ZWRGcmllbmRzRmlsdGVyIiwiY291bnQiOjUsInNlY3Rpb25fdHlwZSI6Mn1dLCJyZXF1ZXN0X2ludGVyZXN0cyI6eyIkZ3BiIjoiYmFkb28uYm1hLlNlcnZlckludGVyZXN0c0dldCIsInVzZXJfaWQiOmlkLCJsaW1pdCI6NTAwfX0sInZpc2l0aW5nX3NvdXJjZSI6eyIkZ3BiIjoiYmFkb28uYm1hLlByb2ZpbGVWaXNpdGluZ1NvdXJjZSIsInBlcnNvbl9pZCI6aWQsInNvdXJjZV9mb2xkZXIiOjI1LCJ2aXNpdGluZ19zb3VyY2UiOjJ9fX1dfTsKCgkJdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKCQkJYm90Ll9zZW5kUmVxdWVzdCh1cmwsIGJvZHkpLnRoZW4oZnVuY3Rpb24odXNlcil7CgkJCQl1c2VyID0gdXNlci5ib2R5WzBdLnVzZXI7CgoJCQkJcmVzb2x2ZSh1c2VyKTsKCQkJfSk7CgkJfSk7CgkJcmV0dXJuIHByb21pc2U7Cgl9LAoKCWdldFVzZXJzOiBmdW5jdGlvbihwYWdlID0gMCl7CgkJdmFyIHVybCA9ICIvYXBpLnBodG1sP1NFUlZFUl9HRVRfVVNFUl9MSVNUX1dJVEhfU0VUVElOR1MiOwoKCQlib2R5ID0geyJ2ZXJzaW9uIjoxLCJtZXNzYWdlX3R5cGUiOjQxNiwibWVzc2FnZV9pZCI6MjQsImJvZHkiOlt7Im1lc3NhZ2VfdHlwZSI6NTAyLCJzZXJ2ZXJfZ2V0X3NlYXJjaF9zZXR0aW5ncyI6eyJjb250ZXh0X3R5cGUiOjJ9fSx7Im1lc3NhZ2VfdHlwZSI6MjQ1LCJzZXJ2ZXJfZ2V0X3VzZXJfbGlzdCI6eyJmb2xkZXJfaWQiOjI1LCJ1c2VyX2ZpZWxkX2ZpbHRlciI6eyJwcm9qZWN0aW9uIjpbMjUwLDIwMCwyMTAsMjMwLDMxMCwzMzAsNTMwLDU0MCwzNDAsMzMxLDY4MCwyOTAsMjkxLDMwMSwzMDMsMzA0LDMwMiwyNjBdLCJwcm9maWxlX3Bob3RvX3NpemUiOnsic3F1YXJlX2ZhY2VfcGhvdG9fc2l6ZSI6eyJ3aWR0aCI6MTgwLCJoZWlnaHQiOjE4MH19fSwib2Zmc2V0IjpwYWdlKjEwMCwicHJlZmVycmVkX2NvdW50IjoxMDAsInByb21vX2Jsb2NrX3JlcXVlc3RfcGFyYW1zIjpbeyJjb3VudCI6MSwicG9zaXRpb24iOjJ9LHsiY291bnQiOjEsInBvc2l0aW9uIjoxfV0sImZpbHRlciI6WzBdfX1dfTsKCgkJdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKCQkJYm90Ll9zZW5kUmVxdWVzdCh1cmwsIGJvZHkpLnRoZW4oZnVuY3Rpb24odXNlcnMpewoJCQkJdmFyIHBhZ2VfY291bnQgPSB1c2Vycy5ib2R5WzFdLmNsaWVudF91c2VyX2xpc3QudG90YWxfY291bnQgLyAxMDA7CgkJCQl1c2VycyA9IHVzZXJzLmJvZHlbMV0uY2xpZW50X3VzZXJfbGlzdC5zZWN0aW9uWzBdLnVzZXJzOwoKCQkJCWlmKHBhZ2UgPT0gMCl7CgkJCQkJcHJvbWlzZXMgPSBbXTsKCgkJCQkJZm9yKGkgPSAxOyBpIDwgcGFnZV9jb3VudDsgaSsrKXsKCQkJCQkJcHJvbWlzZXMucHVzaChib3QuZ2V0VXNlcnMoaSkpOwoJCQkJCX0KCgkJCQkJUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24obW9yZV91c2Vycyl7CgkJCQkJCW1vcmVfdXNlcnMuZm9yRWFjaChmdW5jdGlvbihtb3JlX3VzZXJzX3VuaXQpewoJCQkJCQkJdXNlcnMgPSB1c2Vycy5jb25jYXQobW9yZV91c2Vyc191bml0KTsKCQkJCQkJfSk7CgoJCQkJCQlyZXNvbHZlKHVzZXJzKTsKCQkJCQl9KTsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQlyZXNvbHZlKHVzZXJzKTsKCQkJCX0KCQkJfSk7CgkJfSk7CgoJCXJldHVybiBwcm9taXNlOwoJfSwKCgl2b3RlOiBmdW5jdGlvbihpZCl7CgkJdmFyIHVybCA9ICIvYXBpLnBodG1sP1NFUlZFUl9FTkNPVU5URVJTX1ZPVEUiOwoKCQl2YXIgYm9keSA9IHsiJGdwYiI6ImJhZG9vLmJtYS5CYWRvb01lc3NhZ2UiLCJ2ZXJzaW9uIjoxLCJtZXNzYWdlX3R5cGUiOjgwLCJtZXNzYWdlX2lkIjo1NiwiYm9keSI6W3siJGdwYiI6ImJhZG9vLmJtYS5NZXNzYWdlQm9keSIsIm1lc3NhZ2VfdHlwZSI6ODAsInNlcnZlcl9lbmNvdW50ZXJzX3ZvdGUiOnsiJGdwYiI6ImJhZG9vLmJtYS5TZXJ2ZXJFbmNvdW50ZXJzVm90ZSIsInBlcnNvbl9pZCI6aWQsInZvdGUiOjIsInZvdGVfc291cmNlIjo2NX19XX07CgoJCXJldHVybiB0aGlzLl9zZW5kUmVxdWVzdCh1cmwsIGJvZHkpOwoJfSwKCglfc2VuZFJlcXVlc3QodXJsLCBib2R5KXsKCQl2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewoJCQl2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CgkJCXhoci5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTsKCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdqc29uJyk7CgoJCQl4aHIuc2V0UmVxdWVzdEhlYWRlcignWC1TZXNzaW9uLWlkJywgQi5TZXNzaW9uLmdldFNlc3Npb25JZCgpKTsKCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtVXNlci1pZCcsIEIuU2Vzc2lvbi5nZXRVc2VySWQoKSk7CgoJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gKGZ1bmN0aW9uKCkgewoJCQkJaWYgKHhoci5yZWFkeVN0YXRlID09IFhNTEh0dHBSZXF1ZXN0LkRPTkUpIHsKCQkJCQlyZXNvbHZlKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkpOwoJCQkJfQoJCQl9KTsKCgkJCXhoci5zZW5kKEpTT04uc3RyaW5naWZ5KGJvZHkpKTsKCQl9KTsKCgkJcmV0dXJuIHByb21pc2U7Cgl9LAoKCWFkZFRvTWVudUxpa2UoKXsKCQl2YXIgaHRtbCA9ICdcCgkJPHNwYW4gb25jbGljaz0id2luZG93LmJvdC5tYXNzTGlrZSgpOyIgY2xhc3M9InNpZGViYXItbWVudV9faXRlbS1sbmsiPlwKCQkJPGkgY2xhc3M9Imljb24tc3ZnIGljb24tc3ZnLS14c20iPlwKCQkJCTxzdmcgY2xhc3M9Imljb24tc3ZnXyI+XAoJCQkJCTx1c2UgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhsaW5rOmhyZWY9IiNpY29uLWhlYXJ0Ij5cCgkJCQkJPC91c2U+XAoJCQkJPC9zdmc+XAoJCQk8L2k+XAoJCQk8YiBjbGFzcz0ic2lkZWJhcl9fZWwtaGlkZGVuIj5NYXNzIGxpa2U8L2I+XAoJCTwvc3Bhbj4nOwoKCQl2YXIgbWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInNpZGViYXItbWVudSIpWzBdOwoKCQl2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CgkJZWxlbWVudC5jbGFzc05hbWUgPSAic2lkZWJhci1tZW51X19pdGVtIHNlYXJjaF8iOwoKCQllbGVtZW50LmlubmVySFRNTCA9IGh0bWw7CgoJCW1lbnUuYXBwZW5kQ2hpbGQoZWxlbWVudCkKCX0sCgoJYWRkVG9NZW51Q2hhdCgpewoJCXZhciBodG1sID0gJ1wKCQk8c3BhbiBvbmNsaWNrPSJ3aW5kb3cuYm90Lm1hc3NDaGF0KCk7IiBjbGFzcz0ic2lkZWJhci1tZW51X19pdGVtLWxuayI+XAoJCQk8aSBjbGFzcz0iaWNvbi1zdmcgaWNvbi1zdmctLXhzbSI+XAoJCQkJPHN2ZyBjbGFzcz0iaWNvbi1zdmdfIj5cCgkJCQkJPHVzZSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI2ljb24tY2hhdCI+XAoJCQkJCTwvdXNlPlwKCQkJCTwvc3ZnPlwKCQkJPC9pPlwKCQkJPGIgY2xhc3M9InNpZGViYXJfX2VsLWhpZGRlbiI+TWFzcyBjaGF0PC9iPlwKCQk8L3NwYW4+JzsKCgkJdmFyIG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJzaWRlYmFyLW1lbnUiKVswXTsKCgkJdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwoJCWVsZW1lbnQuY2xhc3NOYW1lID0gInNpZGViYXItbWVudV9faXRlbSBzZWFyY2hfIjsKCgkJZWxlbWVudC5pbm5lckhUTUwgPSBodG1sOwoKCQltZW51LmFwcGVuZENoaWxkKGVsZW1lbnQpCgl9LAoKCWFkZFRvTWVudU9wZW5lcigpewoJCXZhciBodG1sID0gJ1wKCQk8c3BhbiBvbmNsaWNrPSJ3aW5kb3cuYm90LnNldE9wZW5lcigpOyIgY2xhc3M9InNpZGViYXItbWVudV9faXRlbS1sbmsiPlwKCQkJPGkgY2xhc3M9Imljb24tc3ZnIGljb24tc3ZnLS14c20iPlwKCQkJCTxzdmcgY2xhc3M9Imljb24tc3ZnXyI+XAoJCQkJCTx1c2UgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhsaW5rOmhyZWY9IiNpY29uLWNoYXQiPlwKCQkJCQk8L3VzZT5cCgkJCQk8L3N2Zz5cCgkJCTwvaT5cCgkJCTxiIGNsYXNzPSJzaWRlYmFyX19lbC1oaWRkZW4iPlNldCBvcGVuZXI8L2I+XAoJCTwvc3Bhbj4nOwoKCQl2YXIgbWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInNpZGViYXItbWVudSIpWzBdOwoKCQl2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CgkJZWxlbWVudC5jbGFzc05hbWUgPSAic2lkZWJhci1tZW51X19pdGVtIHNlYXJjaF8iOwoKCQllbGVtZW50LmlubmVySFRNTCA9IGh0bWw7CgoJCW1lbnUuYXBwZW5kQ2hpbGQoZWxlbWVudCkKCX0sCgoJc2V0T3BlbmVyOiBmdW5jdGlvbigpewoJCXZhciBvcGVuZXIgPSBwcm9tcHQoIk9wZW5lcj8gIiwgd2luZG93Lm9wZW5lcik7CgoJCXdpbmRvdy5vcGVuZXIgPSBvcGVuZXI7CgkJbG9jYWxTdG9yYWdlLnNldEl0ZW0oIm9wZW5lciIsIG9wZW5lcik7Cgl9LAoKCW1hc3NMaWtlOiBmdW5jdGlvbigpewoJCWJvdC5nZXRVc2VycygpLnRoZW4oZnVuY3Rpb24oZGF0YSl7CgkJCXVzZXJzID0gZGF0YS5maWx0ZXIoZnVuY3Rpb24odXNlcil7cmV0dXJuIHVzZXIub25saW5lX3N0YXR1c190ZXh0ICE9ICJvbmxpbmVfc3RhdHVzX3RleHQiICYmIHVzZXIub25saW5lX3N0YXR1c190ZXh0ICE9ICJCaWxhIGplIG5hIG1yZcW+aSBwcmUgdmnFoWUgb2QgbmVkZWxqdSBkYW5hIiAmJiB1c2VyLm9ubGluZV9zdGF0dXNfdGV4dCAhPSAiIFdhcyBvbmxpbmUgbW9yZSB0aGFuIGEgd2VlayBhZ28ifSk7CgoJCQl1c2VycyA9IHVzZXJzLm1hcChmdW5jdGlvbih1c2VyKXtyZXR1cm4gdXNlci51c2VyX2lkfSk7CgoJCQl1c2VycyA9IHVzZXJzLmZpbHRlcihmdW5jdGlvbih1c2VyKXsKCQkJCWlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyLSIrdXNlcikgIT0gdW5kZWZpbmVkKXsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgoJCQkJcmV0dXJuIHRydWU7CgkJCX0pOwoKCQkJdXNlcnMgPSB1c2Vycy5zbGljZSgwLCAxMDApOwoKCQkJdmFyIHVzZXJEZXRhaWxzUHJvbWlzZXMgPSB1c2Vycy5tYXAoZnVuY3Rpb24odXNlcl9pZCl7CgkJCQlyZXR1cm4gYm90LmdldFVzZXIodXNlcl9pZCk7CgkJCX0pOwoKCQkJUHJvbWlzZS5hbGwodXNlckRldGFpbHNQcm9taXNlcykudGhlbihmdW5jdGlvbih1c2Vycyl7CgkJCQl2YXIgY2FwdGNoYSA9IGZhbHNlOwoKCQkJCXVzZXJzID0gdXNlcnMuZmlsdGVyKGZ1bmN0aW9uKHVzZXIpewoJCQkJCWlmKHVzZXIgPT0gdW5kZWZpbmVkKXsKCQkJCQkJY2FwdGNoYSA9IHRydWU7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQkJZWxzZSBpZih1c2VyLm15X3ZvdGUgPT0gMSl7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidXNlci0iICsgdXNlci51c2VyX2lkLCB0cnVlKTsKCgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9KTsKCgkJCQlpZihjYXB0Y2hhKXsKCQkJCQlhbGVydCgiU29sdmUgY2FwdGNoYSEgIik7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCWNvbnNvbGUubG9nKHVzZXJzLmxlbmd0aCArICIgdXNlcnMgdG8gbGlrZSEgIik7CgoJCQkJbGlrZV9wcm9taXNlcyA9IHVzZXJzLm1hcChmdW5jdGlvbih1c2VyKXtyZXR1cm4gYm90LnZvdGUodXNlci51c2VyX2lkKX0pOwoKCQkJCVByb21pc2UuYWxsKGxpa2VfcHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oZGF0YSl7CgkJCQkJdmFyIGxpa2VzX2NvdW50ID0gMDsKCgkJCQkJZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGxpa2UsIGtleSl7CgkJCQkJCWlmKGxpa2UuYm9keVswXS5tZXNzYWdlX3R5cGUgIT0gMSl7CgkJCQkJCQlsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidXNlci0iICsgdXNlcnNba2V5XS51c2VyX2lkLCB0cnVlKTsKCgkJCQkJCQlsaWtlc19jb3VudCsrOwoJCQkJCQl9CgkJCQkJfSk7CgoJCQkJCWFsZXJ0KCJMaWtlZCAiICsgbGlrZXNfY291bnQgKyAiIHVzZXJzISAiKTsKCQkJCX0pOwoJCQl9KTsKCQl9KTsKCX0sCgoJbWFzc0NoYXQ6IGZ1bmN0aW9uKCl7CgkJYm90LmdldFVzZXJzKCkudGhlbihmdW5jdGlvbihkYXRhKXsKCQkJdXNlcnMgPSBkYXRhLmZpbHRlcihmdW5jdGlvbih1c2VyKXtyZXR1cm4gdXNlci5vbmxpbmVfc3RhdHVzX3RleHQgIT0gIm9ubGluZV9zdGF0dXNfdGV4dCIgJiYgdXNlci5vbmxpbmVfc3RhdHVzX3RleHQgIT0gIkJpbGEgamUgbmEgbXJlxb5pIHByZSB2acWhZSBvZCBuZWRlbGp1IGRhbmEiICYmIHVzZXIub25saW5lX3N0YXR1c190ZXh0ICE9ICIgV2FzIG9ubGluZSBtb3JlIHRoYW4gYSB3ZWVrIGFnbyJ9KTsKCgkJCXVzZXJzID0gdXNlcnMubWFwKGZ1bmN0aW9uKHVzZXIpe3JldHVybiB1c2VyLnVzZXJfaWR9KTsKCgkJCXZhciBjaGF0cyA9IHVzZXJzLm1hcChmdW5jdGlvbihpZCl7CgkJCQlyZXR1cm4gYm90LmdldENoYXQoaWQpOwoJCQl9KTsKCgkJCVByb21pc2UuYWxsKGNoYXRzKS50aGVuKGZ1bmN0aW9uKGNoYXRzKXsKCQkJCXVzZXJzID0gdXNlcnMuZmlsdGVyKGZ1bmN0aW9uKGlkLCBrZXkpewoJCQkJCXJldHVybiBjaGF0c1trZXldOwoJCQkJfSk7CgoJCQkJYWxlcnQoIlNlbmRpbmcgbWVzc2FnZSB0byAiK3VzZXJzLmxlbmd0aCsiIHBlb3BsZSEgIik7CgoJCQkJdXNlcnMubWFwKGZ1bmN0aW9uKGlkKXsKCQkJCQlib3Quc2VuZE1lc3NhZ2UoaWQpOwoJCQkJfSkKCQkJfSk7CgkJfSk7Cgl9Cn07Cgp2YXIgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpewoJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgic2lkZWJhci1tZW51IilbMF0gIT09IHVuZGVmaW5lZCl7CgkJY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CgkJYm90LmFkZFRvTWVudUxpa2UoKTsKCQlib3QuYWRkVG9NZW51Q2hhdCgpOwoJCWJvdC5hZGRUb01lbnVPcGVuZXIoKTsKCX0KfSwgMTAwMCk7Cgo=");

location.href="javascript:(function(){" + code + "})()";

